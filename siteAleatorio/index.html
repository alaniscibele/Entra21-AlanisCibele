<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      const { EOL } = require("os");
      const os = require("os");
      const fsPromises = require("fs/promises");
      const path = require("path");

      setInterval(async () => {
        const freeMemory = parseInt(os.freemem() / 1024 / 1024),
          totalMemory = parseInt(os.totalmem() / 1024 / 1024),
          usage = parseInt((freeMemory * 100) / totalMemory);

        const content = {
          freeMemory: `${freeMemory} MB`,
          totalMemory: `${totalMemory} MB`,
          usage: `${usage} %`,
        };

        const contentInJSON = JSON.stringify(content) + EOL;

        try {
          await fsPromises.appendFile(
            path.resolve(__dirname, "log.txt"),
            contentInJSON
          );
          console.log("Log adicionado");
        } catch (err) {
          console.log(err.message);
        }
      }, 5000);

      const path = require("path");
      const fsPromises = require("fs/promises");
      const { EOL } = require("os");
      (async () => {
        try {
          const data = await fsPromises.readFile(
            path.resolve(__dirname, "exercicioNomes.txt")
          );
          const nomes = data.toString("utf-8").split(EOL);
          const nomesComA = nomes.filter(
            (nome) => nome[0].toUpperCase() === "A"
          );
          console.log(nomesComA);
        } catch (err) {
          console.log(err.message);
        }
      })();

      const fsPromises = require("fs/promises");
      const path = require("path");

      async function getUserByName(name) {
        try {
          const data = await fsPromises.readFile(
            path.resolve(__dirname, "users.json")
          );
          const users = JSON.parse(data.toString("utf-8"));

          const user = users.find((user) => user.nome === name);

          return user;
        } catch (err) {
          console.log(err.message);
        }
      }

      (async () => {
        const user = await getUserByName("Pedr");

        if (user) {
          console.log(
            `Usuário encontrado:\nnome: ${user.nome}\nidade: ${user.idade}\nemail: ${user.email}`
          );
        } else {
          console.log("Usuário não foi encontrado!");
        }
      })();
    </script>
  </body>
</html>
